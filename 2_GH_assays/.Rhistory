norm <- rbind(norm1, norm2)
return(norm)
}
norm <-lapply(list.gen, rgr.cal2)
norm <- do.call(rbind, norm)
df <- read.table("data/GA_SG_outdoors.txt", sep = "\t", header = T)
list.gen <- (unique(df$genotype))
rgr.cal2 <- function(x){
df <- df %>% filter(genotype == x)
w2.c <- df %>% filter(week == "w2") %>% filter(cage == "Control")
w2.h <- df %>% filter(week == "w2") %>% filter(cage == "Herbivory")
w8.c <- df %>% filter(week == "w8") %>% filter(cage == "Control")
w8.h <- df %>% filter(week == "w8") %>% filter(cage == "Herbivory")
norm1 <- data.frame(genotype = x, treatment = "Control", pond = w8.c$pond, weight = (log(w8.c$tot_weight) - log(w2.c$tot_weight))/42, area = (log(w8.c$area) - log(w2.c$area))/42)
norm2 <- data.frame(genotype = x, treatment = "Herbivory", pond = w8.h$pond, weight = (log(w8.h$tot_weight) - log(w2.h$tot_weight))/42, area = (log(w8.h$area) - log(w2.h$area))/42)
norm <- rbind(norm1, norm2)
return(norm)
}
norm <-lapply(list.gen, rgr.cal2)
norm <- do.call(rbind, norm)
View(df)
df <- read.table("data/GA_SG_outdoors.txt", sep = "\t", header = T)
list.gen <- (unique(df$genotype))
rgr.cal2 <- function(x){
df <- df %>% filter(genotype == x)
w2.c <- df %>% filter(week == "w2") %>% filter(cage == "Control")
w2.h <- df %>% filter(week == "w2") %>% filter(cage == "Herbivory")
w8.c <- df %>% filter(week == "w8") %>% filter(cage == "Control")
w8.h <- df %>% filter(week == "w8") %>% filter(cage == "Herbivory")
norm1 <- data.frame(genotype = x, treatment = "Control", pond = w8.c$pond, weight = (log(w8.c$tot_weight) - log(w2.c$tot_weight))/42, area = (log(w8.c$area) - log(w2.c$area))/42)
norm2 <- data.frame(genotype = x, treatment = "Herbivory", pond = w8.h$pond, weight = (log(w8.h$tot_weight) - log(w2.h$tot_weight))/42, area = (log(w8.h$area) - log(w2.h$area))/42)
norm <- rbind(norm1, norm2)
return(norm)
}
norm <-lapply(list.gen, rgr.cal2)
norm <- do.call(rbind, norm)
norm <- rbind(norm1, norm2)
return(norm)
}
norm <-lapply(list.gen, rgr.cal2)
norm <- do.call(rbind, norm)
df <- read.table("data/GA_SG_outdoors.txt", sep = "\t", header = T)
list.gen <- (unique(df$genotype))
rgr.cal2 <- function(x){
df <- df %>% filter(genotype == x)
w2.c <- df %>% filter(week == "w2") %>% filter(cage == "Control")
w2.h <- df %>% filter(week == "w2") %>% filter(cage == "Herbivory")
w8.c <- df %>% filter(week == "w8") %>% filter(cage == "Control")
w8.h <- df %>% filter(week == "w8") %>% filter(cage == "Herbivory")
norm1 <- data.frame(genotype = x, treatment = "Control", pond = w8.c$pond, weight = (log(w8.c$tot_weight) - log(w2.c$tot_weight))/42, area = (log(w8.c$area) - log(w2.c$area))/42)
norm2 <- data.frame(genotype = x, treatment = "Herbivory", pond = w8.h$pond, weight = (log(w8.h$tot_weight) - log(w2.h$tot_weight))/42, area = (log(w8.h$area) - log(w2.h$area))/42)
norm <- rbind(norm1, norm2)
return(norm)
}
norm <-lapply(list.gen, rgr.cal2)
norm <- do.call(rbind, norm)
df <- read.table("data/GA_SG_outdoors.txt", sep = "\t", header = T)
list.gen <- (unique(df$genotype))
rgr.cal2 <- function(x){
df <- df %>% filter(genotype == x)
w2.c <- df %>% filter(week == "w2") %>% filter(cage == "Control")
w2.h <- df %>% filter(week == "w2") %>% filter(cage == "Herbivory")
w8.c <- df %>% filter(week == "w8") %>% filter(cage == "Control")
w8.h <- df %>% filter(week == "w8") %>% filter(cage == "Herbivory")
norm1 <- data.frame(genotype = x, treatment = "Control", pond = w8.c$pond, weight = (log(w8.c$biomass) - log(w2.c$biomass))/42, area = (log(w8.c$area) - log(w2.c$area))/42)
norm2 <- data.frame(genotype = x, treatment = "Herbivory", pond = w8.h$pond, weight = (log(w8.h$biomass) - log(w2.h$biomass))/42, area = (log(w8.h$area) - log(w2.h$area))/42)
norm <- rbind(norm1, norm2)
return(norm)
}
norm <-lapply(list.gen, rgr.cal2)
norm <- do.call(rbind, norm)
View(norm)
model <- lmer(weight ~ Ggnotype * treatment * (1|pond), data = norm)
Anova(model)
model <- lmer(weight ~ Ggnotype * treatment * (1|pond), data = norm)
Anova(model)
model <- lmer(weight ~ genotype * treatment * (1|pond), data = norm)
Anova(model)
model <- lmer(area ~ genotype * treatment  * (1|pond), data = norm)
Anova(model)
df_ha <- read.table("data/HA_SG_outdoors.txt", sep = "\t", header = T)
View(df_ha)
norm.cal<- function(x){
df$biomass2 <- (df$biomass/30)*100
df$area2 <- (df$area/30)*100
norm.cal<- function(x){
df$biomass2 <- (df$biomass/30)*100
df$area2 <- (df$area/30)*100
refs.c <- df %>% filter(genotype == x) %>% filter(cage == "Control") %>% filter(week == "w8") %>% sample_n(., nperm, replace = T)
refs.h <- df %>% filter(genotype == x) %>% filter(cage == "Herbivory") %>% filter(week == "w8") %>% sample_n(., nperm, replace = T)
expl.c <- df_ha %>% filter(genotype == x) %>% filter(cage == "Control") %>% sample_n(., nperm, replace = T)
expl.h <- df_ha %>% filter(genotype == x) %>% filter(cage == "Herbivory")  %>% sample_n(., nperm, replace = T)
refs <- rbind(refs.c, refs.h)
expl <- rbind(expl.c, expl.h)
norm <- data.frame(
genotype = genotype,
pond = expl$pond,
cage = expl$cage,
biomass = refs$biomass2 - expl$biomass,
area = refs$area2 - expl$area
)
return(norm)
}
norm <-lapply(list.gen, norm.cal)
norm <- do.call(rbind, norm)
norm.cal<- function(x){
df$biomass2 <- (df$biomass/30)*100
df$area2 <- (df$area/30)*100
refs.c <- df %>% filter(genotype == x) %>% filter(cage == "Control") %>% filter(week == "w8") %>% sample_n(., nperm, replace = T)
refs.h <- df %>% filter(genotype == x) %>% filter(cage == "Herbivory") %>% filter(week == "w8") %>% sample_n(., nperm, replace = T)
expl.c <- df_ha %>% filter(genotype == x) %>% filter(cage == "Control") %>% sample_n(., nperm, replace = T)
expl.h <- df_ha %>% filter(genotype == x) %>% filter(cage == "Herbivory")  %>% sample_n(., nperm, replace = T)
refs <- rbind(refs.c, refs.h)
expl <- rbind(expl.c, expl.h)
norm <- data.frame(
genotype = expl$genotype,
pond = expl$pond,
cage = expl$cage,
biomass = refs$biomass2 - expl$biomass,
area = refs$area2 - expl$area
)
return(norm)
}
norm <-lapply(list.gen, norm.cal)
norm <- do.call(rbind, norm)
model <- lmer(biomass ~ genotype * cage * (1|pond), data = norm)
Anova(model)
df <- read.table("data/GA_SG_outdoors.txt", sep = "\t", header = T)
list.gen <- (unique(df$genotype))
rgr.cal2 <- function(x){
df <- df %>% filter(genotype == x)
w2.c <- df %>% filter(week == "w2") %>% filter(cage == "Control")
w2.h <- df %>% filter(week == "w2") %>% filter(cage == "Herbivory")
w8.c <- df %>% filter(week == "w8") %>% filter(cage == "Control")
w8.h <- df %>% filter(week == "w8") %>% filter(cage == "Herbivory")
norm1 <- data.frame(genotype = x, treatment = "Control", pond = w8.c$pond, weight = (log(w8.c$biomass) - log(w2.c$biomass))/42, area = (log(w8.c$area) - log(w2.c$area))/42)
norm2 <- data.frame(genotype = x, treatment = "Herbivory", pond = w8.h$pond, weight = (log(w8.h$biomass) - log(w2.h$biomass))/42, area = (log(w8.h$area) - log(w2.h$area))/42)
norm <- rbind(norm1, norm2)
return(norm)
}
norm <-lapply(list.gen, rgr.cal2)
norm <- do.call(rbind, norm)
model <- lmer(weight ~ genotype * treatment * (1|pond), data = norm)
Anova(model)
model <- lmer(area ~ genotype * treatment  * (1|pond), data = norm)
Anova(model)
df_ha <- read.table("data/HA_SG_outdoors.txt", sep = "\t", header = T)
norm.cal<- function(x){
df$biomass2 <- (df$biomass/30)*100
df$area2 <- (df$area/30)*100
set.seeds(100)
refs.c <- df %>% filter(genotype == x) %>% filter(cage == "Control") %>% filter(week == "w8") %>% sample_n(., nperm, replace = T)
refs.h <- df %>% filter(genotype == x) %>% filter(cage == "Herbivory") %>% filter(week == "w8") %>% sample_n(., nperm, replace = T)
expl.c <- df_ha %>% filter(genotype == x) %>% filter(cage == "Control") %>% sample_n(., nperm, replace = T)
expl.h <- df_ha %>% filter(genotype == x) %>% filter(cage == "Herbivory")  %>% sample_n(., nperm, replace = T)
refs <- rbind(refs.c, refs.h)
expl <- rbind(expl.c, expl.h)
norm <- data.frame(
genotype = expl$genotype,
pond = expl$pond,
cage = expl$cage,
biomass = refs$biomass2 - expl$biomass,
area = refs$area2 - expl$area
)
return(norm)
}
norm <-lapply(list.gen, norm.cal)
norm <- do.call(rbind, norm)
model <- lmer(biomass ~ genotype * cage * (1|pond), data = norm)
Anova(model)
df <- read.table("data/GA_SG_outdoors.txt", sep = "\t", header = T)
list.gen <- (unique(df$genotype))
rgr.cal2 <- function(x){
df <- df %>% filter(genotype == x)
w2.c <- df %>% filter(week == "w2") %>% filter(cage == "Control")
w2.h <- df %>% filter(week == "w2") %>% filter(cage == "Herbivory")
w8.c <- df %>% filter(week == "w8") %>% filter(cage == "Control")
w8.h <- df %>% filter(week == "w8") %>% filter(cage == "Herbivory")
norm1 <- data.frame(genotype = x, treatment = "Control", pond = w8.c$pond, weight = (log(w8.c$biomass) - log(w2.c$biomass))/42, area = (log(w8.c$area) - log(w2.c$area))/42)
norm2 <- data.frame(genotype = x, treatment = "Herbivory", pond = w8.h$pond, weight = (log(w8.h$biomass) - log(w2.h$biomass))/42, area = (log(w8.h$area) - log(w2.h$area))/42)
norm <- rbind(norm1, norm2)
return(norm)
}
norm <-lapply(list.gen, rgr.cal2)
norm <- do.call(rbind, norm)
model <- lmer(weight ~ genotype * treatment * (1|pond), data = norm)
Anova(model)
model <- lmer(area ~ genotype * treatment  * (1|pond), data = norm)
Anova(model)
df_ha <- read.table("data/HA_SG_outdoors.txt", sep = "\t", header = T)
norm.cal<- function(x){
df$biomass2 <- (df$biomass/30)*100
df$area2 <- (df$area/30)*100
set.seeds(100)
refs.c <- df %>% filter(genotype == x) %>% filter(cage == "Control") %>% filter(week == "w8") %>% sample_n(., nperm, replace = T)
refs.h <- df %>% filter(genotype == x) %>% filter(cage == "Herbivory") %>% filter(week == "w8") %>% sample_n(., nperm, replace = T)
expl.c <- df_ha %>% filter(genotype == x) %>% filter(cage == "Control") %>% sample_n(., nperm, replace = T)
expl.h <- df_ha %>% filter(genotype == x) %>% filter(cage == "Herbivory")  %>% sample_n(., nperm, replace = T)
refs <- rbind(refs.c, refs.h)
expl <- rbind(expl.c, expl.h)
norm <- data.frame(
genotype = expl$genotype,
pond = expl$pond,
cage = expl$cage,
biomass = refs$biomass2 - expl$biomass,
area = refs$area2 - expl$area
)
return(norm)
}
norm <-lapply(list.gen, norm.cal)
norm <- do.call(rbind, norm)
model <- lmer(biomass ~ genotype * cage * (1|pond), data = norm)
Anova(model)
df <- read.table("data/GA_SG_outdoors.txt", sep = "\t", header = T)
list.gen <- (unique(df$genotype))
rgr.cal2 <- function(x){
df <- df %>% filter(genotype == x)
w2.c <- df %>% filter(week == "w2") %>% filter(cage == "Control")
w2.h <- df %>% filter(week == "w2") %>% filter(cage == "Herbivory")
w8.c <- df %>% filter(week == "w8") %>% filter(cage == "Control")
w8.h <- df %>% filter(week == "w8") %>% filter(cage == "Herbivory")
norm1 <- data.frame(genotype = x, treatment = "Control", pond = w8.c$pond, weight = (log(w8.c$biomass) - log(w2.c$biomass))/42, area = (log(w8.c$area) - log(w2.c$area))/42)
norm2 <- data.frame(genotype = x, treatment = "Herbivory", pond = w8.h$pond, weight = (log(w8.h$biomass) - log(w2.h$biomass))/42, area = (log(w8.h$area) - log(w2.h$area))/42)
norm <- rbind(norm1, norm2)
return(norm)
}
norm <-lapply(list.gen, rgr.cal2)
norm <- do.call(rbind, norm)
model <- lmer(weight ~ genotype * treatment * (1|pond), data = norm)
Anova(model)
model <- lmer(area ~ genotype * treatment  * (1|pond), data = norm)
Anova(model)
df_ha <- read.table("data/HA_SG_outdoors.txt", sep = "\t", header = T)
norm.cal<- function(x){
df$biomass2 <- (df$biomass/30)*100
df$area2 <- (df$area/30)*100
set.seed(100)
refs.c <- df %>% filter(genotype == x) %>% filter(cage == "Control") %>% filter(week == "w8") %>% sample_n(., nperm, replace = T)
refs.h <- df %>% filter(genotype == x) %>% filter(cage == "Herbivory") %>% filter(week == "w8") %>% sample_n(., nperm, replace = T)
expl.c <- df_ha %>% filter(genotype == x) %>% filter(cage == "Control") %>% sample_n(., nperm, replace = T)
expl.h <- df_ha %>% filter(genotype == x) %>% filter(cage == "Herbivory")  %>% sample_n(., nperm, replace = T)
refs <- rbind(refs.c, refs.h)
expl <- rbind(expl.c, expl.h)
norm <- data.frame(
genotype = expl$genotype,
pond = expl$pond,
cage = expl$cage,
biomass = refs$biomass2 - expl$biomass,
area = refs$area2 - expl$area
)
return(norm)
}
norm <-lapply(list.gen, norm.cal)
norm <- do.call(rbind, norm)
model <- lmer(biomass ~ genotype * cage * (1|pond), data = norm)
Anova(model)
df <- read.table("data/GA_SG_outdoors.txt", sep = "\t", header = T)
list.gen <- (unique(df$genotype))
rgr.cal2 <- function(x){
df <- df %>% filter(genotype == x)
w2.c <- df %>% filter(week == "w2") %>% filter(cage == "Control")
w2.h <- df %>% filter(week == "w2") %>% filter(cage == "Herbivory")
w8.c <- df %>% filter(week == "w8") %>% filter(cage == "Control")
w8.h <- df %>% filter(week == "w8") %>% filter(cage == "Herbivory")
norm1 <- data.frame(genotype = x, treatment = "Control", pond = w8.c$pond, weight = (log(w8.c$biomass) - log(w2.c$biomass))/42, area = (log(w8.c$area) - log(w2.c$area))/42)
norm2 <- data.frame(genotype = x, treatment = "Herbivory", pond = w8.h$pond, weight = (log(w8.h$biomass) - log(w2.h$biomass))/42, area = (log(w8.h$area) - log(w2.h$area))/42)
norm <- rbind(norm1, norm2)
return(norm)
}
norm <-lapply(list.gen, rgr.cal2)
norm <- do.call(rbind, norm)
model <- lmer(weight ~ genotype * treatment * (1|pond), data = norm)
Anova(model)
model <- lmer(area ~ genotype * treatment  * (1|pond), data = norm)
Anova(model)
df_ha <- read.table("data/HA_SG_outdoors.txt", sep = "\t", header = T)
norm.cal<- function(x){
df$biomass2 <- (df$biomass/30)*100
df$area2 <- (df$area/30)*100
set.seed(100)
refs.c <- df %>% filter(genotype == x) %>% filter(cage == "Control") %>% filter(week == "w8") %>% sample_n(., nperm, replace = T)
refs.h <- df %>% filter(genotype == x) %>% filter(cage == "Herbivory") %>% filter(week == "w8") %>% sample_n(., nperm, replace = T)
expl.c <- df_ha %>% filter(genotype == x) %>% filter(cage == "Control") %>% sample_n(., nperm, replace = T)
expl.h <- df_ha %>% filter(genotype == x) %>% filter(cage == "Herbivory")  %>% sample_n(., nperm, replace = T)
refs <- rbind(refs.c, refs.h)
expl <- rbind(expl.c, expl.h)
norm <- data.frame(
genotype = expl$genotype,
pond = expl$pond,
cage = expl$cage,
biomass = refs$biomass2 - expl$biomass,
area = refs$area2 - expl$area
)
return(norm)
}
norm <-lapply(list.gen, norm.cal)
norm <- do.call(rbind, norm)
model <- lmer(biomass ~ genotype * cage * (1|pond), data = norm)
Anova(model)
model <- lmer(area ~ genotype * cage * (1|pond), data = norm)
Anova(model)
norm.cal<- function(x){
df$biomass2 <- (df$biomass/30)
df$area2 <- (df$area/30)
set.seed(100)
refs.c <- df %>% filter(genotype == x) %>% filter(cage == "Control") %>% filter(week == "w8") %>% sample_n(., nperm, replace = T)
refs.h <- df %>% filter(genotype == x) %>% filter(cage == "Herbivory") %>% filter(week == "w8") %>% sample_n(., nperm, replace = T)
expl.c <- df_ha %>% filter(genotype == x) %>% filter(cage == "Control") %>% sample_n(., nperm, replace = T)
expl.h <- df_ha %>% filter(genotype == x) %>% filter(cage == "Herbivory")  %>% sample_n(., nperm, replace = T)
refs <- rbind(refs.c, refs.h)
expl <- rbind(expl.c, expl.h)
norm <- data.frame(
genotype = expl$genotype,
pond = expl$pond,
cage = expl$cage,
biomass = refs$biomass2 - expl$biomass,
area = refs$area2 - expl$area
)
return(norm)
}
norm <-lapply(list.gen, norm.cal)
norm <- do.call(rbind, norm)
model <- lmer(biomass ~ genotype * cage * (1|pond), data = norm)
Anova(model)
model <- lmer(area ~ genotype * cage * (1|pond), data = norm)
Anova(model)
View(df)
View(df_ha)
View(df_ha)
View(df_ha)
norm.cal<- function(x){
df$biomass2 <- (df$biomass/df$count)
df$area2 <- (df$area/df$count)
df_ha$biomass2 <- (df_ha$biomass/(100-df_ha$consumed))
df_ha$area2 <- (df$area/(100-df_ha$consumed))
set.seed(100)
refs.c <- df %>% filter(genotype == x) %>% filter(cage == "Control") %>% filter(week == "w8") %>% sample_n(., nperm, replace = T)
refs.h <- df %>% filter(genotype == x) %>% filter(cage == "Herbivory") %>% filter(week == "w8") %>% sample_n(., nperm, replace = T)
expl.c <- df_ha %>% filter(genotype == x) %>% filter(cage == "Control") %>% sample_n(., nperm, replace = T)
expl.h <- df_ha %>% filter(genotype == x) %>% filter(cage == "Herbivory")  %>% sample_n(., nperm, replace = T)
refs <- rbind(refs.c, refs.h)
expl <- rbind(expl.c, expl.h)
norm <- data.frame(
genotype = expl$genotype,
pond = expl$pond,
cage = expl$cage,
biomass = refs$biomass2 - expl$biomass,
area = refs$area2 - expl$area
)
return(norm)
}
norm <-lapply(list.gen, norm.cal)
norm <- do.call(rbind, norm)
model <- lmer(biomass ~ genotype * cage * (1|pond), data = norm)
Anova(model)
model <- lmer(area ~ genotype * cage * (1|pond), data = norm)
Anova(model)
norm.cal<- function(x){
df$biomass2 <- (df$biomass/df$count)
df$area2 <- (df$area/df$count)
df_ha$biomass2 <- (df_ha$biomass/(100-df_ha$consumed))
df_ha$area2 <- (df$area/(100-df_ha$consumed))
set.seed(100)
refs.c <- df %>% filter(genotype == x) %>% filter(cage == "Control") %>% filter(week == "w8") %>% sample_n(., nperm, replace = T)
refs.h <- df %>% filter(genotype == x) %>% filter(cage == "Herbivory") %>% filter(week == "w8") %>% sample_n(., nperm, replace = T)
expl.c <- df_ha %>% filter(genotype == x) %>% filter(cage == "Control") %>% sample_n(., nperm, replace = T)
expl.h <- df_ha %>% filter(genotype == x) %>% filter(cage == "Herbivory")  %>% sample_n(., nperm, replace = T)
refs <- rbind(refs.c, refs.h)
expl <- rbind(expl.c, expl.h)
norm <- data.frame(
genotype = expl$genotype,
pond = expl$pond,
cage = expl$cage,
biomass = refs$biomass2 - expl$biomass2,
area = refs$area2 - expl$area2
)
return(norm)
}
norm <-lapply(list.gen, norm.cal)
norm <- do.call(rbind, norm)
model <- lmer(biomass ~ genotype * cage * (1|pond), data = norm)
Anova(model)
model <- lmer(area ~ genotype * cage * (1|pond), data = norm)
Anova(model)
norm.cal<- function(x){
df$biomass2 <- (df$biomass/df$count)
df$area2 <- (df$area/df$count)
df_ha$biomass2 <- (df_ha$biomass/df_ha$consumed)
df_ha$area2 <- (df$area/df_ha$consumed)
set.seed(100)
refs.c <- df %>% filter(genotype == x) %>% filter(cage == "Control") %>% filter(week == "w8") %>% sample_n(., nperm, replace = T)
refs.h <- df %>% filter(genotype == x) %>% filter(cage == "Herbivory") %>% filter(week == "w8") %>% sample_n(., nperm, replace = T)
expl.c <- df_ha %>% filter(genotype == x) %>% filter(cage == "Control") %>% sample_n(., nperm, replace = T)
expl.h <- df_ha %>% filter(genotype == x) %>% filter(cage == "Herbivory")  %>% sample_n(., nperm, replace = T)
refs <- rbind(refs.c, refs.h)
expl <- rbind(expl.c, expl.h)
norm <- data.frame(
genotype = expl$genotype,
pond = expl$pond,
cage = expl$cage,
biomass = refs$biomass2 - expl$biomass2,
area = refs$area2 - expl$area2
)
return(norm)
}
norm <-lapply(list.gen, norm.cal)
norm <- do.call(rbind, norm)
model <- lmer(biomass ~ genotype * cage * (1|pond), data = norm)
Anova(model)
model <- lmer(area ~ genotype * cage * (1|pond), data = norm)
Anova(model)
norm.cal<- function(x){
df$biomass2 <- (df$biomass/df$count)
df$area2 <- (df$area/df$count)
df_ha$biomass2 <- (df_ha$biomass/(100-df_ha$consumed))
df_ha$area2 <- (df_ha$area/(100-df_ha$consumed))
set.seed(100)
refs.c <- df %>% filter(genotype == x) %>% filter(cage == "Control") %>% filter(week == "w8") %>% sample_n(., nperm, replace = T)
refs.h <- df %>% filter(genotype == x) %>% filter(cage == "Herbivory") %>% filter(week == "w8") %>% sample_n(., nperm, replace = T)
expl.c <- df_ha %>% filter(genotype == x) %>% filter(cage == "Control") %>% sample_n(., nperm, replace = T)
expl.h <- df_ha %>% filter(genotype == x) %>% filter(cage == "Herbivory")  %>% sample_n(., nperm, replace = T)
refs <- rbind(refs.c, refs.h)
expl <- rbind(expl.c, expl.h)
norm <- data.frame(
genotype = expl$genotype,
pond = expl$pond,
cage = expl$cage,
biomass = refs$biomass2 - expl$biomass2,
area = refs$area2 - expl$area2
)
return(norm)
}
norm <-lapply(list.gen, norm.cal)
norm <- do.call(rbind, norm)
model <- lmer(biomass ~ genotype * cage * (1|pond), data = norm)
Anova(model)
model <- lmer(area ~ genotype * cage * (1|pond), data = norm)
Anova(model)
View(norm)
View(df_ha)
norm.cal<- function(x){
#df$biomass2 <- (df$biomass/df$count)
df$area2 <- (df$area/df$count)
#df_ha$biomass2 <- (df_ha$biomass/(100-df_ha$consumed))
df_ha$area2 <- (df_ha$area/(100-df_ha$consumed))
set.seed(100)
refs.c <- df %>% filter(genotype == x) %>% filter(cage == "Control") %>% filter(week == "w8") %>% sample_n(., nperm, replace = T)
refs.h <- df %>% filter(genotype == x) %>% filter(cage == "Herbivory") %>% filter(week == "w8") %>% sample_n(., nperm, replace = T)
expl.c <- df_ha %>% filter(genotype == x) %>% filter(cage == "Control") %>% sample_n(., nperm, replace = T)
expl.h <- df_ha %>% filter(genotype == x) %>% filter(cage == "Herbivory")  %>% sample_n(., nperm, replace = T)
refs <- rbind(refs.c, refs.h)
expl <- rbind(expl.c, expl.h)
norm <- data.frame(
genotype = expl$genotype,
pond = expl$pond,
cage = expl$cage,
biomass = refs$biomass - expl$biomass,
area = refs$area2 - expl$area2
)
return(norm)
}
norm <-lapply(list.gen, norm.cal)
norm <- do.call(rbind, norm)
model <- lmer(biomass ~ genotype * cage * (1|pond), data = norm)
Anova(model)
model <- lmer(area ~ genotype * cage * (1|pond), data = norm)
Anova(model)
df <- read.table("data/GA_SG_outdoors.txt", sep = "\t", header = T)
list.gen <- (unique(df$genotype))
rgr.cal2 <- function(x){
df <- df %>% filter(genotype == x)
w2.c <- df %>% filter(week == "w2") %>% filter(cage == "Control")
w2.h <- df %>% filter(week == "w2") %>% filter(cage == "Herbivory")
w8.c <- df %>% filter(week == "w8") %>% filter(cage == "Control")
w8.h <- df %>% filter(week == "w8") %>% filter(cage == "Herbivory")
norm1 <- data.frame(genotype = x, treatment = "Control", pond = w8.c$pond, weight = (log(w8.c$biomass) - log(w2.c$biomass))/42, area = (log(w8.c$area) - log(w2.c$area))/42)
norm2 <- data.frame(genotype = x, treatment = "Herbivory", pond = w8.h$pond, weight = (log(w8.h$biomass) - log(w2.h$biomass))/42, area = (log(w8.h$area) - log(w2.h$area))/42)
norm <- rbind(norm1, norm2)
return(norm)
}
norm <-lapply(list.gen, rgr.cal2)
norm <- do.call(rbind, norm)
model <- lmer(weight ~ genotype * treatment * (1|pond), data = norm)
Anova(model)
model <- lmer(area ~ genotype * treatment  * (1|pond), data = norm)
Anova(model)
df_ha <- read.table("data/HA_SG_outdoors.txt", sep = "\t", header = T)
norm.cal<- function(x){
df$area2 <- (df$area/df$count)
df_ha$area2 <- (df_ha$area/(100-df_ha$consumed))
set.seed(100)
refs.c <- df %>% filter(genotype == x) %>% filter(cage == "Control") %>% filter(week == "w8") %>% sample_n(., nperm, replace = T)
refs.h <- df %>% filter(genotype == x) %>% filter(cage == "Herbivory") %>% filter(week == "w8") %>% sample_n(., nperm, replace = T)
expl.c <- df_ha %>% filter(genotype == x) %>% filter(cage == "Control") %>% sample_n(., nperm, replace = T)
expl.h <- df_ha %>% filter(genotype == x) %>% filter(cage == "Herbivory")  %>% sample_n(., nperm, replace = T)
refs <- rbind(refs.c, refs.h)
expl <- rbind(expl.c, expl.h)
norm <- data.frame(
genotype = expl$genotype,
pond = expl$pond,
cage = expl$cage,
biomass = refs$biomass - expl$biomass,
area = refs$area2 - expl$area2
)
return(norm)
}
norm <-lapply(list.gen, norm.cal)
norm <- do.call(rbind, norm)
model <- lmer(biomass ~ genotype * cage * (1|pond), data = norm)
Anova(model)
model <- lmer(area ~ genotype * cage * (1|pond), data = norm)
Anova(model)
